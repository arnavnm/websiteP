{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nimport { ModelPredicateCreator } from '../predicates';\nimport { QueryOne } from '../types';\nimport { USER, SYNC, valuesEqual } from '../util';\nimport { TransformerMutationType } from './utils'; // TODO: Persist deleted ids\n// https://github.com/aws-amplify/amplify-js/blob/datastore-docs/packages/datastore/docs/sync-engine.md#outbox\n\nvar MutationEventOutbox =\n/** @class */\nfunction () {\n  function MutationEventOutbox(schema, MutationEvent, modelInstanceCreator, ownSymbol) {\n    this.schema = schema;\n    this.MutationEvent = MutationEvent;\n    this.modelInstanceCreator = modelInstanceCreator;\n    this.ownSymbol = ownSymbol;\n  }\n\n  MutationEventOutbox.prototype.enqueue = function (storage, mutationEvent) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        storage.runExclusive(function (s) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var mutationEventModelDefinition, predicate, _a, first, incomingMutationType, merged_1, incomingConditionJSON, incomingCondition, merged;\n\n            var _this = this;\n\n            return __generator(this, function (_b) {\n              switch (_b.label) {\n                case 0:\n                  mutationEventModelDefinition = this.schema.namespaces[SYNC].models['MutationEvent'];\n                  predicate = ModelPredicateCreator.createFromExisting(mutationEventModelDefinition, function (c) {\n                    return c.modelId('eq', mutationEvent.modelId).id('ne', _this.inProgressMutationEventId);\n                  });\n                  return [4\n                  /*yield*/\n                  , s.query(this.MutationEvent, predicate)];\n\n                case 1:\n                  _a = __read.apply(void 0, [_b.sent(), 1]), first = _a[0];\n                  if (!(first === undefined)) return [3\n                  /*break*/\n                  , 3];\n                  return [4\n                  /*yield*/\n                  , s.save(mutationEvent, undefined, this.ownSymbol)];\n\n                case 2:\n                  _b.sent();\n\n                  return [2\n                  /*return*/\n                  ];\n\n                case 3:\n                  incomingMutationType = mutationEvent.operation;\n                  if (!(first.operation === TransformerMutationType.CREATE)) return [3\n                  /*break*/\n                  , 8];\n                  if (!(incomingMutationType === TransformerMutationType.DELETE)) return [3\n                  /*break*/\n                  , 5];\n                  return [4\n                  /*yield*/\n                  , s.delete(this.MutationEvent, predicate)];\n\n                case 4:\n                  _b.sent();\n\n                  return [3\n                  /*break*/\n                  , 7];\n\n                case 5:\n                  merged_1 = this.mergeUserFields(first, mutationEvent);\n                  return [4\n                  /*yield*/\n                  , s.save(this.MutationEvent.copyOf(first, function (draft) {\n                    draft.data = merged_1.data;\n                  }), undefined, this.ownSymbol)];\n\n                case 6:\n                  _b.sent();\n\n                  _b.label = 7;\n\n                case 7:\n                  return [3\n                  /*break*/\n                  , 12];\n\n                case 8:\n                  incomingConditionJSON = mutationEvent.condition;\n                  incomingCondition = JSON.parse(incomingConditionJSON);\n                  merged = void 0;\n                  if (!(Object.keys(incomingCondition).length === 0)) return [3\n                  /*break*/\n                  , 10];\n                  merged = this.mergeUserFields(first, mutationEvent); // delete all for model\n\n                  return [4\n                  /*yield*/\n                  , s.delete(this.MutationEvent, predicate)];\n\n                case 9:\n                  // delete all for model\n                  _b.sent();\n\n                  _b.label = 10;\n\n                case 10:\n                  merged = merged || mutationEvent; // Enqueue new one\n\n                  return [4\n                  /*yield*/\n                  , s.save(merged, undefined, this.ownSymbol)];\n\n                case 11:\n                  // Enqueue new one\n                  _b.sent();\n\n                  _b.label = 12;\n\n                case 12:\n                  return [2\n                  /*return*/\n                  ];\n              }\n            });\n          });\n        });\n        return [2\n        /*return*/\n        ];\n      });\n    });\n  };\n\n  MutationEventOutbox.prototype.dequeue = function (storage, record, recordOp) {\n    return __awaiter(this, void 0, void 0, function () {\n      var head;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.peek(storage)];\n\n          case 1:\n            head = _a.sent();\n            if (!record) return [3\n            /*break*/\n            , 3];\n            return [4\n            /*yield*/\n            , this.syncOutboxVersionsOnDequeue(storage, record, head, recordOp)];\n\n          case 2:\n            _a.sent();\n\n            _a.label = 3;\n\n          case 3:\n            return [4\n            /*yield*/\n            , storage.delete(head)];\n\n          case 4:\n            _a.sent();\n\n            this.inProgressMutationEventId = undefined;\n            return [2\n            /*return*/\n            , head];\n        }\n      });\n    });\n  };\n  /**\n   * Doing a peek() implies that the mutation goes \"inProgress\"\n   *\n   * @param storage\n   */\n\n\n  MutationEventOutbox.prototype.peek = function (storage) {\n    return __awaiter(this, void 0, void 0, function () {\n      var head;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , storage.queryOne(this.MutationEvent, QueryOne.FIRST)];\n\n          case 1:\n            head = _a.sent();\n            this.inProgressMutationEventId = head ? head.id : undefined;\n            return [2\n            /*return*/\n            , head];\n        }\n      });\n    });\n  };\n\n  MutationEventOutbox.prototype.getForModel = function (storage, model) {\n    return __awaiter(this, void 0, void 0, function () {\n      var mutationEventModelDefinition, mutationEvents;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            mutationEventModelDefinition = this.schema.namespaces[SYNC].models.MutationEvent;\n            return [4\n            /*yield*/\n            , storage.query(this.MutationEvent, ModelPredicateCreator.createFromExisting(mutationEventModelDefinition, function (c) {\n              return c.modelId('eq', model.id);\n            }))];\n\n          case 1:\n            mutationEvents = _a.sent();\n            return [2\n            /*return*/\n            , mutationEvents];\n        }\n      });\n    });\n  };\n\n  MutationEventOutbox.prototype.getModelIds = function (storage) {\n    return __awaiter(this, void 0, void 0, function () {\n      var mutationEvents, result;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , storage.query(this.MutationEvent)];\n\n          case 1:\n            mutationEvents = _a.sent();\n            result = new Set();\n            mutationEvents.forEach(function (_a) {\n              var modelId = _a.modelId;\n              return result.add(modelId);\n            });\n            return [2\n            /*return*/\n            , result];\n        }\n      });\n    });\n  }; // applies _version from the AppSync mutation response to other items\n  // in the mutation queue with the same id\n  // see https://github.com/aws-amplify/amplify-js/pull/7354 for more details\n\n\n  MutationEventOutbox.prototype.syncOutboxVersionsOnDequeue = function (storage, record, head, recordOp) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _version, _lastChangedAt, _deleted, _incomingData, incomingData, data, __version, __lastChangedAt, __deleted, _outgoingData, outgoingData, mutationEventModelDefinition, predicate, outdatedMutations, reconciledMutations;\n\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (head.operation !== recordOp) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            _version = record._version, _lastChangedAt = record._lastChangedAt, _deleted = record._deleted, _incomingData = __rest(record, [\"_version\", \"_lastChangedAt\", \"_deleted\"]);\n            incomingData = this.removeTimestampFields(head.model, _incomingData);\n            data = JSON.parse(head.data);\n\n            if (!data) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            __version = data._version, __lastChangedAt = data._lastChangedAt, __deleted = data._deleted, _outgoingData = __rest(data, [\"_version\", \"_lastChangedAt\", \"_deleted\"]);\n            outgoingData = this.removeTimestampFields(head.model, _outgoingData); // Don't sync the version when the data in the response does not match the data\n            // in the request, i.e., when there's a handled conflict\n\n            if (!valuesEqual(incomingData, outgoingData, true)) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            mutationEventModelDefinition = this.schema.namespaces[SYNC].models['MutationEvent'];\n            predicate = ModelPredicateCreator.createFromExisting(mutationEventModelDefinition, function (c) {\n              return c.modelId('eq', record.id).id('ne', _this.inProgressMutationEventId);\n            });\n            return [4\n            /*yield*/\n            , storage.query(this.MutationEvent, predicate)];\n\n          case 1:\n            outdatedMutations = _a.sent();\n\n            if (!outdatedMutations.length) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            reconciledMutations = outdatedMutations.map(function (m) {\n              var oldData = JSON.parse(m.data);\n\n              var newData = __assign(__assign({}, oldData), {\n                _version: _version,\n                _lastChangedAt: _lastChangedAt\n              });\n\n              return _this.MutationEvent.copyOf(m, function (draft) {\n                draft.data = JSON.stringify(newData);\n              });\n            });\n            return [4\n            /*yield*/\n            , storage.delete(this.MutationEvent, predicate)];\n\n          case 2:\n            _a.sent();\n\n            return [4\n            /*yield*/\n            , Promise.all(reconciledMutations.map(function (m) {\n              return __awaiter(_this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4\n                      /*yield*/\n                      , storage.save(m, undefined, this.ownSymbol)];\n\n                    case 1:\n                      return [2\n                      /*return*/\n                      , _a.sent()];\n                  }\n                });\n              });\n            }))];\n\n          case 3:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  MutationEventOutbox.prototype.mergeUserFields = function (previous, current) {\n    var _a = JSON.parse(previous.data),\n        _version = _a._version,\n        id = _a.id,\n        _lastChangedAt = _a._lastChangedAt,\n        _deleted = _a._deleted,\n        previousData = __rest(_a, [\"_version\", \"id\", \"_lastChangedAt\", \"_deleted\"]);\n\n    var _b = JSON.parse(current.data),\n        __id = _b.id,\n        __version = _b._version,\n        __lastChangedAt = _b._lastChangedAt,\n        __deleted = _b._deleted,\n        currentData = __rest(_b, [\"id\", \"_version\", \"_lastChangedAt\", \"_deleted\"]);\n\n    var data = JSON.stringify(__assign(__assign({\n      id: id,\n      _version: _version,\n      _lastChangedAt: _lastChangedAt,\n      _deleted: _deleted\n    }, previousData), currentData));\n    return this.modelInstanceCreator(this.MutationEvent, __assign(__assign({}, current), {\n      data: data\n    }));\n  };\n  /*\n  if a model is using custom timestamp fields\n  the custom field names will be stored in the model attributes\n   e.g.\n  \"attributes\": [\n  {\n          \"type\": \"model\",\n          \"properties\": {\n              \"timestamps\": {\n                  \"createdAt\": \"createdOn\",\n                  \"updatedAt\": \"updatedOn\"\n              }\n          }\n  }\n  ]\n  */\n\n\n  MutationEventOutbox.prototype.removeTimestampFields = function (model, record) {\n    var _a, _b;\n\n    var CREATED_AT_DEFAULT_KEY = 'createdAt';\n    var UPDATED_AT_DEFAULT_KEY = 'updatedAt';\n    var createdTimestampKey = CREATED_AT_DEFAULT_KEY;\n    var updatedTimestampKey = UPDATED_AT_DEFAULT_KEY;\n    var modelAttributes = (_a = this.schema.namespaces[USER].models[model].attributes) === null || _a === void 0 ? void 0 : _a.find(function (attr) {\n      return attr.type === 'model';\n    });\n    var timestampFieldsMap = (_b = modelAttributes === null || modelAttributes === void 0 ? void 0 : modelAttributes.properties) === null || _b === void 0 ? void 0 : _b.timestamps;\n\n    if (timestampFieldsMap) {\n      createdTimestampKey = timestampFieldsMap[CREATED_AT_DEFAULT_KEY];\n      updatedTimestampKey = timestampFieldsMap[UPDATED_AT_DEFAULT_KEY];\n    }\n\n    delete record[createdTimestampKey];\n    delete record[updatedTimestampKey];\n    return record;\n  };\n\n  return MutationEventOutbox;\n}();\n\nexport { MutationEventOutbox };","map":{"version":3,"mappings":"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","names":["ModelPredicateCreator","QueryOne","USER","SYNC","valuesEqual","TransformerMutationType","schema","MutationEvent","modelInstanceCreator","ownSymbol","MutationEventOutbox","storage","mutationEvent","runExclusive","s","mutationEventModelDefinition","namespaces","models","predicate","createFromExisting","modelId","id","_this","inProgressMutationEventId","query","_a","_b","first","undefined","save","incomingMutationType","operation","CREATE","DELETE","delete","merged_1","mergeUserFields","copyOf","draft","data","incomingConditionJSON","incomingCondition","JSON","parse","merged","Object","keys","length","record","recordOp","peek","head","syncOutboxVersionsOnDequeue","queryOne","FIRST","model","mutationEvents","result","Set","forEach","add","_version","_lastChangedAt","_deleted","_incomingData","incomingData","removeTimestampFields","__version","__lastChangedAt","__deleted","_outgoingData","outgoingData","outdatedMutations","reconciledMutations","map","oldData","m","newData","stringify","Promise","all","previous","current","previousData","__id","currentData","__assign","CREATED_AT_DEFAULT_KEY","UPDATED_AT_DEFAULT_KEY","createdTimestampKey","updatedTimestampKey","modelAttributes","attributes","find","type","timestampFieldsMap","properties","timestamps"],"sources":["/Users/arnavmisra/Desktop/Portfolio-main/Portfolio/node_modules/@aws-amplify/datastore/src/sync/outbox.ts"],"sourcesContent":["import { MutationEvent } from './index';\nimport { ModelPredicateCreator } from '../predicates';\nimport {\n\tExclusiveStorage as Storage,\n\tStorageFacade,\n\tStorage as StorageClass,\n} from '../storage/storage';\nimport { ModelInstanceCreator } from '../datastore/datastore';\nimport {\n\tInternalSchema,\n\tPersistentModel,\n\tPersistentModelConstructor,\n\tQueryOne,\n} from '../types';\nimport { USER, SYNC, valuesEqual } from '../util';\nimport { TransformerMutationType } from './utils';\n\n// TODO: Persist deleted ids\n// https://github.com/aws-amplify/amplify-js/blob/datastore-docs/packages/datastore/docs/sync-engine.md#outbox\nclass MutationEventOutbox {\n\tprivate inProgressMutationEventId: string;\n\n\tconstructor(\n\t\tprivate readonly schema: InternalSchema,\n\t\tprivate readonly MutationEvent: PersistentModelConstructor<MutationEvent>,\n\t\tprivate readonly modelInstanceCreator: ModelInstanceCreator,\n\t\tprivate readonly ownSymbol: Symbol\n\t) {}\n\n\tpublic async enqueue(\n\t\tstorage: Storage,\n\t\tmutationEvent: MutationEvent\n\t): Promise<void> {\n\t\tstorage.runExclusive(async s => {\n\t\t\tconst mutationEventModelDefinition =\n\t\t\t\tthis.schema.namespaces[SYNC].models['MutationEvent'];\n\n\t\t\tconst predicate = ModelPredicateCreator.createFromExisting<MutationEvent>(\n\t\t\t\tmutationEventModelDefinition,\n\t\t\t\tc =>\n\t\t\t\t\tc\n\t\t\t\t\t\t.modelId('eq', mutationEvent.modelId)\n\t\t\t\t\t\t.id('ne', this.inProgressMutationEventId)\n\t\t\t);\n\n\t\t\tconst [first] = await s.query(this.MutationEvent, predicate);\n\n\t\t\tif (first === undefined) {\n\t\t\t\tawait s.save(mutationEvent, undefined, this.ownSymbol);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { operation: incomingMutationType } = mutationEvent;\n\n\t\t\tif (first.operation === TransformerMutationType.CREATE) {\n\t\t\t\tif (incomingMutationType === TransformerMutationType.DELETE) {\n\t\t\t\t\tawait s.delete(this.MutationEvent, predicate);\n\t\t\t\t} else {\n\t\t\t\t\t// first gets updated with the incoming mutation's data, condition intentionally skipped\n\n\t\t\t\t\t// we need to merge the fields for a create and update mutation to prevent\n\t\t\t\t\t// data loss, since update mutations only include changed fields\n\t\t\t\t\tconst merged = this.mergeUserFields(first, mutationEvent);\n\t\t\t\t\tawait s.save(\n\t\t\t\t\t\tthis.MutationEvent.copyOf(first, draft => {\n\t\t\t\t\t\t\tdraft.data = merged.data;\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tthis.ownSymbol\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst { condition: incomingConditionJSON } = mutationEvent;\n\t\t\t\tconst incomingCondition = JSON.parse(incomingConditionJSON);\n\t\t\t\tlet merged: MutationEvent;\n\n\t\t\t\t// If no condition\n\t\t\t\tif (Object.keys(incomingCondition).length === 0) {\n\t\t\t\t\tmerged = this.mergeUserFields(first, mutationEvent);\n\n\t\t\t\t\t// delete all for model\n\t\t\t\t\tawait s.delete(this.MutationEvent, predicate);\n\t\t\t\t}\n\n\t\t\t\tmerged = merged || mutationEvent;\n\n\t\t\t\t// Enqueue new one\n\t\t\t\tawait s.save(merged, undefined, this.ownSymbol);\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic async dequeue(\n\t\tstorage: StorageClass,\n\t\trecord?: PersistentModel,\n\t\trecordOp?: TransformerMutationType\n\t): Promise<MutationEvent> {\n\t\tconst head = await this.peek(storage);\n\n\t\tif (record) {\n\t\t\tawait this.syncOutboxVersionsOnDequeue(storage, record, head, recordOp);\n\t\t}\n\n\t\tawait storage.delete(head);\n\t\tthis.inProgressMutationEventId = undefined;\n\n\t\treturn head;\n\t}\n\n\t/**\n\t * Doing a peek() implies that the mutation goes \"inProgress\"\n\t *\n\t * @param storage\n\t */\n\tpublic async peek(storage: StorageFacade): Promise<MutationEvent> {\n\t\tconst head = await storage.queryOne(this.MutationEvent, QueryOne.FIRST);\n\n\t\tthis.inProgressMutationEventId = head ? head.id : undefined;\n\n\t\treturn head;\n\t}\n\n\tpublic async getForModel<T extends PersistentModel>(\n\t\tstorage: StorageFacade,\n\t\tmodel: T\n\t): Promise<MutationEvent[]> {\n\t\tconst mutationEventModelDefinition =\n\t\t\tthis.schema.namespaces[SYNC].models.MutationEvent;\n\n\t\tconst mutationEvents = await storage.query(\n\t\t\tthis.MutationEvent,\n\t\t\tModelPredicateCreator.createFromExisting(\n\t\t\t\tmutationEventModelDefinition,\n\t\t\t\tc => c.modelId('eq', model.id)\n\t\t\t)\n\t\t);\n\n\t\treturn mutationEvents;\n\t}\n\n\tpublic async getModelIds(storage: StorageFacade): Promise<Set<string>> {\n\t\tconst mutationEvents = await storage.query(this.MutationEvent);\n\n\t\tconst result = new Set<string>();\n\n\t\tmutationEvents.forEach(({ modelId }) => result.add(modelId));\n\n\t\treturn result;\n\t}\n\n\t// applies _version from the AppSync mutation response to other items\n\t// in the mutation queue with the same id\n\t// see https://github.com/aws-amplify/amplify-js/pull/7354 for more details\n\tprivate async syncOutboxVersionsOnDequeue(\n\t\tstorage: StorageClass,\n\t\trecord: PersistentModel,\n\t\thead: PersistentModel,\n\t\trecordOp: string\n\t): Promise<void> {\n\t\tif (head.operation !== recordOp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { _version, _lastChangedAt, _deleted, ..._incomingData } = record;\n\t\tconst incomingData = this.removeTimestampFields(head.model, _incomingData);\n\n\t\tconst data = JSON.parse(head.data);\n\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\t_version: __version,\n\t\t\t_lastChangedAt: __lastChangedAt,\n\t\t\t_deleted: __deleted,\n\t\t\t..._outgoingData\n\t\t} = data;\n\t\tconst outgoingData = this.removeTimestampFields(head.model, _outgoingData);\n\n\t\t// Don't sync the version when the data in the response does not match the data\n\t\t// in the request, i.e., when there's a handled conflict\n\t\tif (!valuesEqual(incomingData, outgoingData, true)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst mutationEventModelDefinition =\n\t\t\tthis.schema.namespaces[SYNC].models['MutationEvent'];\n\n\t\tconst predicate = ModelPredicateCreator.createFromExisting<MutationEvent>(\n\t\t\tmutationEventModelDefinition,\n\t\t\tc => c.modelId('eq', record.id).id('ne', this.inProgressMutationEventId)\n\t\t);\n\n\t\tconst outdatedMutations = await storage.query(\n\t\t\tthis.MutationEvent,\n\t\t\tpredicate\n\t\t);\n\n\t\tif (!outdatedMutations.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst reconciledMutations = outdatedMutations.map(m => {\n\t\t\tconst oldData = JSON.parse(m.data);\n\n\t\t\tconst newData = { ...oldData, _version, _lastChangedAt };\n\n\t\t\treturn this.MutationEvent.copyOf(m, draft => {\n\t\t\t\tdraft.data = JSON.stringify(newData);\n\t\t\t});\n\t\t});\n\n\t\tawait storage.delete(this.MutationEvent, predicate);\n\n\t\tawait Promise.all(\n\t\t\treconciledMutations.map(\n\t\t\t\tasync m => await storage.save(m, undefined, this.ownSymbol)\n\t\t\t)\n\t\t);\n\t}\n\n\tprivate mergeUserFields(\n\t\tprevious: MutationEvent,\n\t\tcurrent: MutationEvent\n\t): MutationEvent {\n\t\tconst { _version, id, _lastChangedAt, _deleted, ...previousData } =\n\t\t\tJSON.parse(previous.data);\n\n\t\tconst {\n\t\t\tid: __id,\n\t\t\t_version: __version,\n\t\t\t_lastChangedAt: __lastChangedAt,\n\t\t\t_deleted: __deleted,\n\t\t\t...currentData\n\t\t} = JSON.parse(current.data);\n\n\t\tconst data = JSON.stringify({\n\t\t\tid,\n\t\t\t_version,\n\t\t\t_lastChangedAt,\n\t\t\t_deleted,\n\t\t\t...previousData,\n\t\t\t...currentData,\n\t\t});\n\n\t\treturn this.modelInstanceCreator(this.MutationEvent, {\n\t\t\t...current,\n\t\t\tdata,\n\t\t});\n\t}\n\n\t/* \n\tif a model is using custom timestamp fields\n\tthe custom field names will be stored in the model attributes\n\n\te.g.\n\t\"attributes\": [\n    {\n\t\t\t\"type\": \"model\",\n\t\t\t\"properties\": {\n\t\t\t\t\"timestamps\": {\n\t\t\t\t\t\"createdAt\": \"createdOn\",\n\t\t\t\t\t\"updatedAt\": \"updatedOn\"\n\t\t\t\t}\n\t\t\t}\n    }\n\t]\n\t*/\n\tprivate removeTimestampFields(\n\t\tmodel: string,\n\t\trecord: PersistentModel\n\t): PersistentModel {\n\t\tconst CREATED_AT_DEFAULT_KEY = 'createdAt';\n\t\tconst UPDATED_AT_DEFAULT_KEY = 'updatedAt';\n\n\t\tlet createdTimestampKey = CREATED_AT_DEFAULT_KEY;\n\t\tlet updatedTimestampKey = UPDATED_AT_DEFAULT_KEY;\n\n\t\tconst modelAttributes = this.schema.namespaces[USER].models[\n\t\t\tmodel\n\t\t].attributes?.find(attr => attr.type === 'model');\n\t\tconst timestampFieldsMap = modelAttributes?.properties?.timestamps;\n\n\t\tif (timestampFieldsMap) {\n\t\t\tcreatedTimestampKey = timestampFieldsMap[CREATED_AT_DEFAULT_KEY];\n\t\t\tupdatedTimestampKey = timestampFieldsMap[UPDATED_AT_DEFAULT_KEY];\n\t\t}\n\n\t\tdelete (record as Record<string, any>)[createdTimestampKey];\n\t\tdelete (record as Record<string, any>)[updatedTimestampKey];\n\n\t\treturn record;\n\t}\n}\n\nexport { MutationEventOutbox };\n"]},"metadata":{},"sourceType":"module"}