{"ast":null,"code":"import { __assign, __awaiter, __generator, __read, __spread } from \"tslib\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nimport { SPACE, UA_ESCAPE_REGEX, USER_AGENT, X_AMZ_USER_AGENT } from \"./constants\";\n/**\n * Build user agent header sections from:\n * 1. runtime-specific default user agent provider;\n * 2. custom user agent from `customUserAgent` client config;\n * 3. handler execution context set by internal SDK components;\n * The built user agent will be set to `x-amz-user-agent` header for ALL the\n * runtimes.\n * Please note that any override to the `user-agent` or `x-amz-user-agent` header\n * in the HTTP request is discouraged. Please use `customUserAgent` client\n * config or middleware setting the `userAgent` context to generate desired user\n * agent.\n */\n\nexport var userAgentMiddleware = function (options) {\n  return function (next, context) {\n    return function (args) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var request, headers, userAgent, defaultUserAgent, customUserAgent, normalUAValue;\n\n        var _a, _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              request = args.request;\n              if (!HttpRequest.isInstance(request)) return [2\n              /*return*/\n              , next(args)];\n              headers = request.headers;\n              userAgent = ((_a = context === null || context === void 0 ? void 0 : context.userAgent) === null || _a === void 0 ? void 0 : _a.map(escapeUserAgent)) || [];\n              return [4\n              /*yield*/\n              , options.defaultUserAgentProvider()];\n\n            case 1:\n              defaultUserAgent = _c.sent().map(escapeUserAgent);\n              customUserAgent = ((_b = options === null || options === void 0 ? void 0 : options.customUserAgent) === null || _b === void 0 ? void 0 : _b.map(escapeUserAgent)) || []; // Set value to AWS-specific user agent header\n\n              headers[X_AMZ_USER_AGENT] = __spread(defaultUserAgent, userAgent, customUserAgent).join(SPACE);\n              normalUAValue = __spread(defaultUserAgent.filter(function (section) {\n                return section.startsWith(\"aws-sdk-\");\n              }), customUserAgent).join(SPACE);\n\n              if (options.runtime !== \"browser\" && normalUAValue) {\n                headers[USER_AGENT] = headers[USER_AGENT] ? headers[USER_AGENT] + \" \" + normalUAValue : normalUAValue;\n              }\n\n              return [2\n              /*return*/\n              , next(__assign(__assign({}, args), {\n                request: request\n              }))];\n          }\n        });\n      });\n    };\n  };\n};\n/**\n * Escape the each pair according to https://tools.ietf.org/html/rfc5234 and join the pair with pattern `name/version`.\n * User agent name may include prefix like `md/`, `api/`, `os/` etc., we should not escape the `/` after the prefix.\n * @private\n */\n\nvar escapeUserAgent = function (_a) {\n  var _b = __read(_a, 2),\n      name = _b[0],\n      version = _b[1];\n\n  var prefixSeparatorIndex = name.indexOf(\"/\");\n  var prefix = name.substring(0, prefixSeparatorIndex); // If no prefix, prefix is just \"\"\n\n  var uaName = name.substring(prefixSeparatorIndex + 1);\n\n  if (prefix === \"api\") {\n    uaName = uaName.toLowerCase();\n  }\n\n  return [prefix, uaName, version].filter(function (item) {\n    return item && item.length > 0;\n  }).map(function (item) {\n    return item === null || item === void 0 ? void 0 : item.replace(UA_ESCAPE_REGEX, \"_\");\n  }).join(\"/\");\n};\n\nexport var getUserAgentMiddlewareOptions = {\n  name: \"getUserAgentMiddleware\",\n  step: \"build\",\n  priority: \"low\",\n  tags: [\"SET_USER_AGENT\", \"USER_AGENT\"],\n  override: true\n};\nexport var getUserAgentPlugin = function (config) {\n  return {\n    applyToStack: function (clientStack) {\n      clientStack.add(userAgentMiddleware(config), getUserAgentMiddlewareOptions);\n    }\n  };\n};","map":{"version":3,"mappings":"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","names":["HttpRequest","SPACE","UA_ESCAPE_REGEX","USER_AGENT","X_AMZ_USER_AGENT","userAgentMiddleware","options","next","context","args","request","isInstance","headers","userAgent","_a","map","escapeUserAgent","defaultUserAgentProvider","defaultUserAgent","_c","customUserAgent","_b","__spread","join","normalUAValue","filter","section","startsWith","runtime","name","version","prefixSeparatorIndex","indexOf","prefix","substring","uaName","toLowerCase","item","length","replace","getUserAgentMiddlewareOptions","step","priority","tags","override","getUserAgentPlugin","config","applyToStack","clientStack","add"],"sources":["/Users/arnavmisra/Desktop/Portfolio-main/node_modules/@aws-sdk/middleware-user-agent/src/user-agent-middleware.ts"],"sourcesContent":["import { HttpRequest } from \"@aws-sdk/protocol-http\";\nimport {\n  AbsoluteLocation,\n  BuildHandler,\n  BuildHandlerArguments,\n  BuildHandlerOptions,\n  BuildHandlerOutput,\n  HandlerExecutionContext,\n  MetadataBearer,\n  Pluggable,\n  UserAgentPair,\n} from \"@aws-sdk/types\";\n\nimport { UserAgentResolvedConfig } from \"./configurations\";\nimport { SPACE, UA_ESCAPE_REGEX, USER_AGENT, X_AMZ_USER_AGENT } from \"./constants\";\n\n/**\n * Build user agent header sections from:\n * 1. runtime-specific default user agent provider;\n * 2. custom user agent from `customUserAgent` client config;\n * 3. handler execution context set by internal SDK components;\n * The built user agent will be set to `x-amz-user-agent` header for ALL the\n * runtimes.\n * Please note that any override to the `user-agent` or `x-amz-user-agent` header\n * in the HTTP request is discouraged. Please use `customUserAgent` client\n * config or middleware setting the `userAgent` context to generate desired user\n * agent.\n */\nexport const userAgentMiddleware = (options: UserAgentResolvedConfig) => <Output extends MetadataBearer>(\n  next: BuildHandler<any, any>,\n  context: HandlerExecutionContext\n): BuildHandler<any, any> => async (args: BuildHandlerArguments<any>): Promise<BuildHandlerOutput<Output>> => {\n  const { request } = args;\n  if (!HttpRequest.isInstance(request)) return next(args);\n  const { headers } = request;\n  const userAgent = context?.userAgent?.map(escapeUserAgent) || [];\n  const defaultUserAgent = (await options.defaultUserAgentProvider()).map(escapeUserAgent);\n  const customUserAgent = options?.customUserAgent?.map(escapeUserAgent) || [];\n  // Set value to AWS-specific user agent header\n  headers[X_AMZ_USER_AGENT] = [...defaultUserAgent, ...userAgent, ...customUserAgent].join(SPACE);\n  // Get value to be sent with non-AWS-specific user agent header.\n  const normalUAValue = [\n    ...defaultUserAgent.filter((section) => section.startsWith(\"aws-sdk-\")),\n    ...customUserAgent,\n  ].join(SPACE);\n  if (options.runtime !== \"browser\" && normalUAValue) {\n    headers[USER_AGENT] = headers[USER_AGENT] ? `${headers[USER_AGENT]} ${normalUAValue}` : normalUAValue;\n  }\n\n  return next({\n    ...args,\n    request,\n  });\n};\n\n/**\n * Escape the each pair according to https://tools.ietf.org/html/rfc5234 and join the pair with pattern `name/version`.\n * User agent name may include prefix like `md/`, `api/`, `os/` etc., we should not escape the `/` after the prefix.\n * @private\n */\nconst escapeUserAgent = ([name, version]: UserAgentPair): string => {\n  const prefixSeparatorIndex = name.indexOf(\"/\");\n  const prefix = name.substring(0, prefixSeparatorIndex); // If no prefix, prefix is just \"\"\n  let uaName = name.substring(prefixSeparatorIndex + 1);\n  if (prefix === \"api\") {\n    uaName = uaName.toLowerCase();\n  }\n  return [prefix, uaName, version]\n    .filter((item) => item && item.length > 0)\n    .map((item) => item?.replace(UA_ESCAPE_REGEX, \"_\"))\n    .join(\"/\");\n};\n\nexport const getUserAgentMiddlewareOptions: BuildHandlerOptions & AbsoluteLocation = {\n  name: \"getUserAgentMiddleware\",\n  step: \"build\",\n  priority: \"low\",\n  tags: [\"SET_USER_AGENT\", \"USER_AGENT\"],\n  override: true,\n};\n\nexport const getUserAgentPlugin = (config: UserAgentResolvedConfig): Pluggable<any, any> => ({\n  applyToStack: (clientStack) => {\n    clientStack.add(userAgentMiddleware(config), getUserAgentMiddlewareOptions);\n  },\n});\n"]},"metadata":{},"sourceType":"module"}