{"ast":null,"code":"import Cookies from 'universal-cookie';\nimport { browserOrNode } from '../JS';\nvar isBrowser = browserOrNode().isBrowser;\n\nvar UniversalStorage =\n/** @class */\nfunction () {\n  function UniversalStorage(context) {\n    if (context === void 0) {\n      context = {};\n    }\n\n    this.cookies = new Cookies();\n    this.store = isBrowser ? window.localStorage : Object.create(null);\n    this.cookies = context.req ? new Cookies(context.req.headers.cookie) : new Cookies();\n    Object.assign(this.store, this.cookies.getAll());\n  }\n\n  Object.defineProperty(UniversalStorage.prototype, \"length\", {\n    get: function get() {\n      return Object.entries(this.store).length;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  UniversalStorage.prototype.clear = function () {\n    var _this = this;\n\n    Array.from(new Array(this.length)).map(function (_, i) {\n      return _this.key(i);\n    }).forEach(function (key) {\n      return _this.removeItem(key);\n    });\n  };\n\n  UniversalStorage.prototype.getItem = function (key) {\n    return this.getLocalItem(key);\n  };\n\n  UniversalStorage.prototype.getLocalItem = function (key) {\n    return Object.prototype.hasOwnProperty.call(this.store, key) ? this.store[key] : null;\n  };\n\n  UniversalStorage.prototype.getUniversalItem = function (key) {\n    return this.cookies.get(key);\n  };\n\n  UniversalStorage.prototype.key = function (index) {\n    return Object.keys(this.store)[index];\n  };\n\n  UniversalStorage.prototype.removeItem = function (key) {\n    this.removeLocalItem(key);\n    this.removeUniversalItem(key);\n  };\n\n  UniversalStorage.prototype.removeLocalItem = function (key) {\n    delete this.store[key];\n  };\n\n  UniversalStorage.prototype.removeUniversalItem = function (key) {\n    this.cookies.remove(key, {\n      path: '/'\n    });\n  };\n\n  UniversalStorage.prototype.setItem = function (key, value) {\n    this.setLocalItem(key, value); // keys take the shape:\n    //  1. `${ProviderPrefix}.${userPoolClientId}.${username}.${tokenType}\n    //  2. `${ProviderPrefix}.${userPoolClientId}.LastAuthUser\n\n    var tokenType = key.split('.').pop();\n\n    switch (tokenType) {\n      // LastAuthUser is needed for computing other key names\n      case 'LastAuthUser': // accessToken is required for CognitoUserSession\n\n      case 'accessToken': // refreshToken originates on the client, but SSR pages won't fail when this expires\n      // Note: the new `accessToken` will also be refreshed on the client (since Amplify doesn't set server-side cookies)\n\n      case 'refreshToken': // Required for CognitoUserSession\n\n      case 'idToken':\n        isBrowser ? this.setUniversalItem(key, value) : this.setLocalItem(key, value);\n      // userData is used when `Auth.currentAuthenticatedUser({ bypassCache: false })`.\n      // Can be persisted to speed up calls to `Auth.currentAuthenticatedUser()`\n      // case 'userData':\n      // Ignoring clockDrift on the server for now, but needs testing\n      // case 'clockDrift':\n    }\n  };\n\n  UniversalStorage.prototype.setLocalItem = function (key, value) {\n    this.store[key] = value;\n  };\n\n  UniversalStorage.prototype.setUniversalItem = function (key, value) {\n    this.cookies.set(key, value, {\n      path: '/',\n      // `httpOnly` cannot be set via JavaScript: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#JavaScript_access_using_Document.cookie\n      sameSite: true,\n      // Allow unsecure requests to http://localhost:3000/ when in development.\n      secure: window.location.hostname === 'localhost' ? false : true\n    });\n  };\n\n  return UniversalStorage;\n}();\n\nexport { UniversalStorage };","map":{"version":3,"mappings":"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","names":["Cookies","browserOrNode","context","isBrowser","window","localStorage","Object","create","cookies","req","headers","cookie","assign","store","getAll","UniversalStorage","entries","length","Array","from","map","_","i","key","forEach","removeItem","getLocalItem","prototype","hasOwnProperty","call","get","index","keys","removeLocalItem","removeUniversalItem","remove","path","value","setLocalItem","tokenType","split","pop","setUniversalItem","set","sameSite","secure","location","hostname"],"sources":["/Users/arnavmisra/Desktop/Portfolio-main/Portfolio/node_modules/@aws-amplify/core/src/UniversalStorage/index.ts"],"sourcesContent":["import Cookies from 'universal-cookie';\nimport { browserOrNode } from '../JS';\n\ntype Store = Record<string, string>;\n\nconst { isBrowser } = browserOrNode();\n\n// Avoid using @types/next because @aws-amplify/ui-angular's version of TypeScript is too old to support it\ntype Context = { req?: any };\n\nexport class UniversalStorage implements Storage {\n\tcookies = new Cookies();\n\tstore: Store = isBrowser ? window.localStorage : Object.create(null);\n\n\tconstructor(context: Context = {}) {\n\t\tthis.cookies = context.req\n\t\t\t? new Cookies(context.req.headers.cookie)\n\t\t\t: new Cookies();\n\n\t\tObject.assign(this.store, this.cookies.getAll());\n\t}\n\n\tget length() {\n\t\treturn Object.entries(this.store).length;\n\t}\n\n\tclear() {\n\t\tArray.from(new Array(this.length))\n\t\t\t.map((_, i) => this.key(i))\n\t\t\t.forEach(key => this.removeItem(key));\n\t}\n\n\tgetItem(key: keyof Store) {\n\t\treturn this.getLocalItem(key);\n\t}\n\n\tprotected getLocalItem(key: keyof Store) {\n\t\treturn Object.prototype.hasOwnProperty.call(this.store, key)\n\t\t\t? this.store[key]\n\t\t\t: null;\n\t}\n\n\tprotected getUniversalItem(key: keyof Store) {\n\t\treturn this.cookies.get(key);\n\t}\n\n\tkey(index: number) {\n\t\treturn Object.keys(this.store)[index];\n\t}\n\n\tremoveItem(key: string) {\n\t\tthis.removeLocalItem(key);\n\t\tthis.removeUniversalItem(key);\n\t}\n\n\tprotected removeLocalItem(key: keyof Store) {\n\t\tdelete this.store[key];\n\t}\n\n\tprotected removeUniversalItem(key: keyof Store) {\n\t\tthis.cookies.remove(key, {\n\t\t\tpath: '/',\n\t\t});\n\t}\n\n\tsetItem(key: keyof Store, value: string) {\n\t\tthis.setLocalItem(key, value);\n\n\t\t// keys take the shape:\n\t\t//  1. `${ProviderPrefix}.${userPoolClientId}.${username}.${tokenType}\n\t\t//  2. `${ProviderPrefix}.${userPoolClientId}.LastAuthUser\n\t\tconst tokenType = key.split('.').pop();\n\n\t\tswitch (tokenType) {\n\t\t\t// LastAuthUser is needed for computing other key names\n\t\t\tcase 'LastAuthUser':\n\n\t\t\t// accessToken is required for CognitoUserSession\n\t\t\tcase 'accessToken':\n\n\t\t\t// refreshToken originates on the client, but SSR pages won't fail when this expires\n\t\t\t// Note: the new `accessToken` will also be refreshed on the client (since Amplify doesn't set server-side cookies)\n\t\t\tcase 'refreshToken':\n\n\t\t\t// Required for CognitoUserSession\n\t\t\tcase 'idToken':\n\t\t\t\tisBrowser\n\t\t\t\t\t? this.setUniversalItem(key, value)\n\t\t\t\t\t: this.setLocalItem(key, value);\n\n\t\t\t// userData is used when `Auth.currentAuthenticatedUser({ bypassCache: false })`.\n\t\t\t// Can be persisted to speed up calls to `Auth.currentAuthenticatedUser()`\n\t\t\t// case 'userData':\n\n\t\t\t// Ignoring clockDrift on the server for now, but needs testing\n\t\t\t// case 'clockDrift':\n\t\t}\n\t}\n\n\tprotected setLocalItem(key: keyof Store, value: string) {\n\t\tthis.store[key] = value;\n\t}\n\n\tprotected setUniversalItem(key: keyof Store, value: string) {\n\t\tthis.cookies.set(key, value, {\n\t\t\tpath: '/',\n\t\t\t// `httpOnly` cannot be set via JavaScript: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#JavaScript_access_using_Document.cookie\n\t\t\tsameSite: true,\n\t\t\t// Allow unsecure requests to http://localhost:3000/ when in development.\n\t\t\tsecure: window.location.hostname === 'localhost' ? false : true,\n\t\t});\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}